(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const d of n)if(d.type==="childList")for(const c of d.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function l(n){const d={};return n.integrity&&(d.integrity=n.integrity),n.referrerPolicy&&(d.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?d.credentials="include":n.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(n){if(n.ep)return;n.ep=!0;const d=l(n);fetch(n.href,d)}})();const D=(t,o,l)=>`
        <button id=${o} role="button" disabled=${l} >${t}</button>
    `;const z=()=>`
        <div id="drop-area" draggable="true">
            <form id="formAction">
                <p>Перетащите фото сюда</p>
                <p>или</p>
                <input type="file" id="fileElem" multiple accept="image/*" >
                <label class="button" for="fileElem">выберите со своего копьютера</label>
            </form>
            <div id="gallery" /></div>
            <p id="maxCountOfPhoto">Максимальное колличество загружаемых файлов - 9.</p>
        </div>
    `,R=()=>`
        <div class="homePage">
            <h1>Выберите фото,<br> на которые вы хотели бы наложить водяной знак</h1>
            ${z()}
            ${D("Далее","nextBtn",!0)}
        </div>
    `;document.querySelector("#app").innerHTML=R();function A(t,o,l){let i=new FileReader;i.readAsDataURL(t),i.onloadend=function(){let n=document.createElement("div");n.classList.add("img-container");let d=document.createElement("img");d.src=i.result,d.id=t.lastModified,n.append(d);let c=document.createElement("div");c.classList.add("trash"),c.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                <path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"/>
                            </svg>`,c.addEventListener("click",l),n.append(c),o.appendChild(n)}}function F(t,o,l){const{text:i,fontSize:n,transparency:d,position:c}=l;let p=document.querySelector("#app"),f=new FileReader;f.readAsDataURL(t),f.onloadend=function(){let g=document.createElement("div");g.classList.add("img-container");let E=document.createElement("img");E.src=f.result;let v=document.createElement("img");v.src=S(E,i),v.id=t.lastModified,g.append(v);let u=document.createElement("div");u.classList.add("eye"),u.innerHTML=`
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                <path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"/>
            </svg>
        `,u.addEventListener("click",()=>{let h=document.createElement("div");h.id="bigImgContainer";let a=document.createElement("img");a.src=v.src,a.id="bigImg";let m=document.createElement("a");m.id="closeBigImg",m.innerText="x",m.addEventListener("click",()=>{p.removeChild(h)}),h.append(a,m),p.appendChild(h)}),g.append(u);function S(h,a){const m=document.createElement("canvas"),r=m.getContext("2d"),e=h.width,s=h.height;switch(m.width=e,m.height=s,r.drawImage(h,0,0,e,s),r.fillStyle=`rgba(255, 225, 225, ${d/100})`,r.font=`bold ${n}pt sans-serif`,c){case"Сверху слева":r.textAlign="start",r.fillText(a,30,40);break;case"Сверху посередине":r.textAlign="center",r.fillText(a,e/2,40);break;case"Сверху справа":r.textAlign="end",r.fillText(a,e-30,40);break;case"Посередине слева":r.textAlign="start",r.fillText(a,30,s/2);break;case"Посередине":r.textAlign="center",r.fillText(a,e/2,s/2);break;case"Посередине справа":r.textAlign="end",r.fillText(a,e-30,s/2);break;case"Снизу слева":r.textAlign="start",r.fillText(a,30,s-40);break;case"Снизу посередине":r.textAlign="center",r.fillText(a,e/2,s-40);break;case"Снизу справа":r.textAlign="end",r.fillText(a,e-30,s-40);break}return m.toDataURL()}o.appendChild(g)}}const U=t=>{let o=document.createElement("div");o.id="editMenu";let l=document.createElement("input");l.type="button",l.id="addTextBtn",l.value="Добавить текст";let i=document.createElement("input");i.type="button",i.id="addLogoBtn",i.value="Добавить логотип",n();function n(){o.appendChild(l),o.innerHTML+="<p>или</p>",o.appendChild(i),o.querySelector("#addTextBtn").addEventListener("click",d),o.querySelector("#addLogoBtn").addEventListener("click",c)}function d(){o.innerHTML="";let p=document.createElement("a");p.innerText="< Назад";let f=document.createElement("form"),g=document.createElement("input");g.type="text",g.id="textValue",g.placeholder="Ваш текст";let E=document.createElement("select");for(let e=10;e<=42;e+=2)m(e,E,"pt");let v=document.createElement("select");for(let e=10;e<=100;e+=10)m(e,v,"%");let u=document.createElement("select");["Сверху слева","Сверху посередине","Сверху справа","Посередине слева","Посередине","Посередине справа","Снизу слева","Снизу посередине","Снизу справа"].forEach(e=>{m(e,u)});let h=document.createElement("input");h.type="submit",h.value="Применить",f.append(a("Текст",g),a("Размер шрифта",E),a("Прозрачность",v),a("Позиция",u),h),o.append(p,f),o.querySelector("a").addEventListener("click",()=>{o.innerHTML="",n()}),o.querySelector("form").addEventListener("submit",r);function a(e,s){let L=document.createElement("div");L.classList.add("setting");let y=document.createElement("p");return y.innerText=e,L.append(y,s),L}function m(e,s,L=""){let y=document.createElement("option");y.value=e,y.innerText=`${e}${L}`,s.appendChild(y)}function r(e){var y,T,H,M;e.preventDefault();let s={text:((y=e==null?void 0:e.target[0])==null?void 0:y.value)||"Ваш текст",fontSize:(T=e==null?void 0:e.target[1])==null?void 0:T.value,transparency:(H=e==null?void 0:e.target[2])==null?void 0:H.value,position:(M=e==null?void 0:e.target[3])==null?void 0:M.value},L=document.querySelector("#editGallery");L.innerHTML="",t.forEach(O=>F(O,L,s))}}function c(){console.log("hey")}return o},N=(t,o={text:"",fontSize:0,transparency:0,position:0})=>{let l=document.createElement("div");l.classList.add("edit-container"),l.innerHTML=`
        <div id="editHeader"> 
        </div>
        <div id="editContent">
        </div>
    `;let i=document.createElement("a");i.innerText="< Назад";let n=document.createElement("button");n.id="downloadFiles",n.innerText="Скачать файлы";let d=document.createElement("div");d.id="editGallery",t.forEach(p=>F(p,d,o)),l.querySelector("#editHeader").append(i,n),l.querySelector("#editContent").append(d,U(t)),l.querySelector("#editHeader a").addEventListener("click",()=>{location.reload()}),l.querySelector("#downloadFiles").addEventListener("click",()=>{document.querySelectorAll(".img-container>img").forEach((f,g)=>{c(f==null?void 0:f.currentSrc,`img-${g+1}`).then(()=>{console.log("The image has been downloaded")}).catch(E=>{console.log("Error downloading image: ",E)})})});async function c(p,f="my-image.png"){const E=await(await fetch(p)).blob(),v=URL.createObjectURL(E),u=document.createElement("a");u.href=v,u.download=f,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(v)}return l};let x=document.getElementById("drop-area"),G=document.getElementById("fileElem"),I=document.getElementById("maxCountOfPhoto"),P=document.getElementById("formAction"),B=document.getElementById("gallery"),C=document.getElementById("nextBtn"),$=document.querySelector("#app");G.addEventListener("change",w);C.addEventListener("click",V);let b=[];["dragenter","dragover","dragleave","drop"].forEach(t=>{x.addEventListener(t,k,!1),document.body.addEventListener(t,k,!1)});["dragenter","dragover"].forEach(t=>{x.addEventListener(t,j,!1)});["dragleave","drop"].forEach(t=>{x.addEventListener(t,W,!1)});x.addEventListener("drop",K,!1);function k(t){t.preventDefault(),t.stopPropagation()}function j(){x.classList.add("highlight")}function W(){x.classList.remove("highlight")}function K(t){let l=t.dataTransfer.files;w(l)}function w(t){var l;let o=[];if(t!=="delete"){let i;"target"in t?i=(l=t.target)==null?void 0:l.files:i=t,i=[...i],i.forEach(n=>{b.length<9&&(b.push(n),o.push(n))})}b.length>=9?(I.style.display="block",P.style.display="none"):(I.style.display="none",P.style.display="block"),b.length>0?C.disabled=!1:C.disabled=!0,t!=="delete"?o.forEach(i=>A(i,B,q)):(B.innerHTML="",b.forEach(i=>A(i,B,q)))}function q(t){var l,i,n,d,c;t.preventDefault();const o=(c=(d=(n=(i=(l=t==null?void 0:t.target)==null?void 0:l.parentNode)==null?void 0:i.parentNode)==null?void 0:n.parentNode)==null?void 0:d.childNodes[0])==null?void 0:c.id;b.splice(b.findIndex(p=>p.lastModified==o),1),w("delete")}function V(){$.innerHTML="",$.appendChild(N(b))}
